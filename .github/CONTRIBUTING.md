# CONTRIBUTING

「キーたん語」の言語拡張（標準モジュールの追加やインタプリタの機能追加）、不具合報告や修正など、**`Qiitan-go` にコントリビュート（参加）したい方はお読みください**。

## はじめに

キーたん語は、Qiitan ファンの共通言語としての「**お遊び用スクリプト言語**」です。

「お遊び」と言っても DoS 攻撃やクラッキングといった類いの、**「悪る遊び」のことではありません**。

キーたん語の言語拡張をして遊ぶ、`qiitan` スクリプトを使ったアプリで遊ぶ、自分の Go アプリに `qiitan` インタプリタを組み込んで遊ぶ、といった<ruby>類<rt>たぐ</rt>い</ruby>のものです。「標準で███の機能を持ってるてwwww」といった、いささかマニアックな実装を楽しんだりするものです。

そして、遊びながら（実装しながら）学びを得る、知見をシェアすることを目的としています。

## CONS

キーたん語は、すでに何かしらのプログラム言語が話せるユーザーをターゲットにしています。一言で言うと「[OSS](https://ja.wikipedia.org/wiki/%E3%82%AA%E3%83%BC%E3%83%97%E3%83%B3%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%BD%E3%83%95%E3%83%88%E3%82%A6%E3%82%A7%E3%82%A2) の、自己責任と貢献を理解しているプログラマが、技術的に面白くて遊ぶための共通言語としてのスクリプト言語」です。

そのため、**初めてプログラムに触る人にはオススメできないプログラム言語**であり、**仕事にも、まったくもって適さないプログラム言語です**。

特に「クレクレ君」の意味がわからない人にはオススメしません。

## PROS

確かに「キーたん語」は「初めてのプログラミング」には適さないプログラム言語です。しかし、多くの Qiitan ファンにとって「キーたん語」は初めてのプログラム言語（スクリプト言語）になります。

そのため「こんなことも知らないのか」「ググレカスに訊け」といった辛辣な対応は NG とします。Qiitan に似合う、マイペースで、まったりした世界が好きな方のためのプログラム言語です。

ドキュメントは、少ないよりは多い方がいいという方針なので、ドキュメントのみの PR も歓迎です。

## Issue と Discussion

不具合報告・脆弱性などは Issues に報告してください。再現性のある簡単なコードを添えていただくと、コントリビュータの皆さんも対応しやすくなります。

判断に迷ったり、機能拡張の提案、使い方や用語の意味などの質問は Discussions でお願いします。ただし、コントリビュータの誰かが気が向いた時でないと反応がない可能性があります。必ず対応されると期待しないでください。

なお、機能の拡張、Bug Fix、typo の修正などは、直接 PR しても構いません。PR の中で仕様を固めていくことも、やぶさかではありません。

## `qiitan` スクリプトの強化

`qiitan` スクリプトを書く上で欲しい機能や、言語の拡張など、遠慮なく PR してください。

- `qiitan` インタプリタの機能強化
    - `qiitan` コマンドの拡張
    - 高速化
    - リファクタリング
- キーたん語の標準機能の強化
    - 標準モジュールの追加（`qiitan` スクリプトの `import()` で使える標準モジュールの追加）
- `qiitan` スクリプトのサンプル追加
- ドキュメントの追加

## PR (Pull Request)

- PR 先: `main` ブランチ
- 初手 Draft PR 推奨ですが、すでに PR 内容が実装済みの場合は普通に直接 PR して構いません。
- PR の粒度は 1 行で具体的な内容が説明できる範囲に絞ってください。レビューが大変な量になると、永遠と放置される可能性があります。
- PR は、マージ時に `squash & merge` で 1 つのコミットにまとめられます。細かくコミットしていただいて構いません。

## Draft PR

これから PR の作成や実装を始める場合は、未実装の状態を `draft` で PR してください。
これにより、他の人は手を付けていることを知ることができ、重複作業が軽減します。

1. ブランチを切る。
2. リポジトリの `/.qiitask/todo.txt` に実装内容を 1 行で記載する。
3. コミットしてブランチを `Upstream`（Fork 元、本家）の `main` へ PR する。<br>（この時 `Draft` を選択しておく。PR のタイトルは `task.txt` の内容と同じで OK）
4. 作業を始め、適宜コミットを `push` してゆく。
5. 途中で飽きたり、挫けたら「Qiitan ごめん。やっぱ出直すわ」とコメントを残して PR をクローズする。
5. 無事、一応の実装が完了したら PR 画面で `draft` を外す。
6. CI（自動テスト）が走るので、CI からの指摘があったら修正する。
7. レビューをお願いする旨をコメントする。

## CI

`push` および `pull request` がリポジトリにあると、GitHub Actions による [CI](https://ja.wikipedia.org/wiki/%E7%B6%99%E7%B6%9A%E7%9A%84%E3%82%A4%E3%83%B3%E3%83%86%E3%82%B0%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3)（各種テスト）が自動で走ります。

これにより、PR 内容が最低限「動く」「壊れてない」「ひどくなっていない」ことをチェックします。このテストをパスしていないと、レビューも行われません。

- 主な CI の内容
    - **[ユニットテスト](https://ja.wikipedia.org/wiki/%E5%8D%98%E4%BD%93%E3%83%86%E3%82%B9%E3%83%88):** `go test ./...` を全てパスしている。
    - **[静的コード解析](https://ja.wikipedia.org/wiki/%E9%9D%99%E7%9A%84%E3%82%B3%E3%83%BC%E3%83%89%E8%A7%A3%E6%9E%90):** `golangci-lint run` を全てパスしている（[解析ルール](../.golangci.yml)）
    - **typo や関数の説明コメント忘れ:** `golint ./...` を全てパスしている。
    - **テストのカバレッジ:** `go-carpet -include-vendor` でカバレッジ率を維持している。

## レビュー

レビューは CI によるテストを全てパスしている PR に行われます。PR が Draft の状態の場合は行われません。

このリポジトリにおけるレビューとは、実装したコードの親（PR 者）離れ的な最終仕上げを意味します。

「入社面接」（マージの面接）というよりは「一人暮らしに必要なチェック」に近いものです。

つまり、マージ後にコードが一人歩きできる（親の PR 者がいなくても周りが面倒をみれる）ように、第三者目線で「いま気になるポイントを指摘する」だけなので、他意はありません。結局、一緒に暮らしてみないと（マージされないと）わからないことも多いからです。

- 主なレビュー内容
    - typo
    - 関数などの命名が他と同じパターンになっているか。
    - 実装内容の設置先が適切か。
    - 実装内容がドキュメントに反映されているか。
    - ドキュメントの文調が他と同じか。
    - 明らかに問題のある処理をしていないか。
    - 「なぜその処理をしているのか」初見でわかりづらくないか。

## コントリビューター

PR が 1 度でもマージされた場合、自動的にコントリビューターとなり、著作者の一員となります。

## コラボレーター（メンテナ）

当リポジトリは、コラボレーターの `appreove` が n 票以上付いた PR は自動でマージされます。（現在 n=3 票）

そのため、コラボレーターは「レビューを行い、マージを決定するメンバーの一員」という扱いになります。

コラボレーターは、複数回 PR しているコントリビューターにリクエストされます。それまでの PR 内容や言動から信頼できると判断された場合に、コラボレーターとしてリクエストされます。

他にも、他のメンテナからの要望や、リポジトリ・オーナーの判断により、コラボレーターをお願いすることがあります。
（現在、n 票なしでマージ権限を持つのはリポジトリ・オーナーのみです）
